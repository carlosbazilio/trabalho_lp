TARGET = main

LIB_NAME = libcontagem.a
LIB_OBJ = contagem.o

SRC_LIB = contagem.c
SRC_TEST = main.c

CC = gcc

CFLAGS = -Wall -Wextra -g

LDFLAGS = -L. -lgc

all: $(TARGET)

$(TARGET): $(LIB_NAME) $(SRC_TEST)
	@echo "üîó Linking o execut√°vel $(TARGET)..."
	$(CC) $(CFLAGS) $(SRC_TEST) -o $(TARGET) $(LDFLAGS)
	@echo "‚úÖ Compila√ß√£o do $(TARGET) conclu√≠da."

$(LIB_NAME): $(LIB_OBJ)
	@echo "üì¶ Criando a biblioteca est√°tica $(LIB_NAME)..."
	ar rcs $(LIB_NAME) $(LIB_OBJ)
	@echo "‚úÖ Biblioteca est√°tica criada."

$(LIB_OBJ): $(SRC_LIB) gc_refcount.h
	@echo "‚öôÔ∏è Compilando o arquivo objeto $(LIB_OBJ)..."
	$(CC) $(CFLAGS) -c $(SRC_LIB) -o $(LIB_OBJ)

.PHONY: clean run

clean:
	@echo "üóëÔ∏è Limpando arquivos gerados..."
	rm -f $(LIB_OBJ) $(LIB_NAME) $(TARGET)
	@echo "Limpeza conclu√≠da."

run: $(TARGET)
	@echo "‚ñ∂Ô∏è Executando $(TARGET)..."
	./$(TARGET)